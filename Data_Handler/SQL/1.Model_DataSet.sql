  -- The following script download data from AL_ARCHIVE for Aldrin ML model
  -- updated 11 OCT 2021 by Marcus Leong
SELECT
  * EXCEPT( -- UUID that not required in the model
    ARCH_DATE,
    policy_quoteno,
    quotecompleted,
    AFNTY_BRAND,
    RATING_LOGGING_KEY)
FROM (
  SELECT
    * EXCEPT (
      -- default value in CTM path that result no variability in data or variance = 0.
      -- keep this in AL_ARCHIVE for future proof but remove it in model, this is marked as std/corr drop.
      BD_AGE,
      BD_GENDER,
      BD_IS_YDNL,
      BD_IS_YOUNGEST,
      BD_LICENCE_HELD_MONTHS,
      BD_LICENCE_TYPE,
      BD_OTHER_VEHICLE,
      BREAKDOWN_PREMIUM,
      CARBON_PREMIUM,
      CHANNEL_TYPE,
      COMMISION_DETAILS,
      DAYS_ON_RISK,
      DRIVERS_YDNL_AGE_DIFFERENCE,
      FINANCIAL_SEQUENCE_NUMBER,
      GLOBAL_LIABILITY_CATEGORY,
      GLOBAL_THEFT_CATEGORY,
      HIRE_CAR_PREMIUM,
      INSTALMENT_PLAN_NUMBER,
      OFFENCES_LOADING_FACTOR,
      ORIGINAL_DAYS_TO_COMMENCEMENT,
      POLICY_SOURCE,
      POLICY_TERM_IN_MONTHS,
      PREMIUM_FACTOR,
      PREVIOUS_POLICY_SEQUENCE_NUMBER,
      PVP_RD_AGE,
      PVP_YD_AGE,
      RD_AD_COUNT_3YR,
      RD_AD_COUNT_5YR,
      RD_AT_FAULT_CLAIM_1YR,
      RD_AT_FAULT_CLAIM_3YR,
      RD_AT_FAULT_CLAIM_5YR,
      RD_AT_FAULT_CLAIM_5YR_PREV,
      RD_CLAIM_COUNT_3YR,
      RD_EXC_WEATHER_COUNT_1YR,
      RD_EXC_WEATHER_COUNT_3YR,
      RD_EXC_WEATHER_COUNT_5YR,
      RD_EXC_WEATHER_COUNT_5YR_P,
      RD_IRS_AF_DRIVING_CLM_1YR,
      RD_IRS_AF_DRIVING_CLM_3YR,
      RD_IRS_AF_DRIVING_CLM_5YR,
      RD_IRS_NAF_DRIVING_CLM_1YR,
      RD_IRS_NAF_DRIVING_CLM_3YR,
      RD_IRS_NAF_DRIVING_CLM_5YR,
      RD_IRS_NOT_DRIVING_CLM_1YR,
      RD_IRS_NOT_DRIVING_CLM_3YR,
      RD_IRS_NOT_DRIVING_CLM_5YR,
      RD_IRS_TOT_CLM_EXC_WEATHER_1YR,
      RD_IRS_TOT_CLM_EXC_WEATHER_3YR,
      RD_IRS_TOT_CLM_EXC_WEATHER_5YR,
      RD_IRS_TOT_CLM_INC_WEATHER_1YR,
      RD_IRS_TOT_CLM_INC_WEATHER_3YR,
      RD_IRS_TOT_CLM_INC_WEATHER_5YR,
      RD_IRS_TOT_DRIVING_CLM_1YR,
      RD_IRS_TOT_DRIVING_CLM_3YR,
      RD_IRS_TOT_DRIVING_CLM_5YR,
      RD_IRS_TOT_LOSS_EXC_WEATHER_1YR,
      RD_IRS_TOT_LOSS_EXC_WEATHER_3YR,
      RD_IRS_TOT_LOSS_EXC_WEATHER_5YR,
      RD_IRS_TOT_LOSS_INC_WEATHER_1YR,
      RD_IRS_TOT_LOSS_INC_WEATHER_3YR,
      RD_IRS_TOT_LOSS_INC_WEATHER_5YR,
      RD_IRS_UNKNOWN_DRIVING_CLM_1YR,
      RD_IRS_UNKNOWN_DRIVING_CLM_3YR,
      RD_IRS_UNKNOWN_DRIVING_CLM_5YR,
      RD_IRS_WINDOW_GLASS_CLM_1YR,
      RD_IRS_WINDOW_GLASS_CLM_3YR,
      RD_IRS_WINDOW_GLASS_CLM_5YR,
      RD_LICENCE_HELD_YEARS,
      RD_THEFT_3YR,
      RD_THEFT_5YR,
      RD_WEATHER_3YR,
      RD_WEATHER_5YR,
      REBROKED_POLICY_SEQUENCE_NUMBER,
      RENEWAL_COUNT,
      RENEWAL_POLICY_SEQUENCE_NUMBER,
      SUSPENSION_LOADING_FACTOR,
      UNDERWRITER_COMPANY,
      UNDERWRITING_FACTOR,
      VEHCAT_WE_FREQ,
      VEHCAT_WE_SEV,
      VEHICLE_PREMIUM,
      WG_CLAIM_1YR,
      WG_CLAIM_3YR,
      WG_CLAIM_5YR,
      YD_LICENCE_HELD_YEARS,
      YDNL_AGE,
      YDNL_GENDER,
      YDNL_LICENCE_HELD_MONTHS,
      YDNL_LICENCE_TYPE,
      YDNL_OTHER_VEHICLE,
      FINANCE_FEE,
      FINANCE_FEE_GST,
      PLAN_NUMBER,
      MODIFICATION_UW_FACTOR,
      PREMIUM_FACTOR2,
      VEHICLE_PREMIUM2,
      VEHICLE_PREMIUM_COMMISSION,
      ODFREQ_TAR_PREM,
      ODFREQ_MOD_PREM,
      ODFREQ_FIN_PREM,
      OD_TAR_PREM,
      OD_MOD_PREM,
      OD_FIN_PREM,
      TPFREQ_TAR_PREM,
      TPFREQ_MOD_PREM,
      TPFREQ_FIN_PREM,
      TP_TAR_PREM,
      TP_MOD_PREM,
      TP_FIN_PREM,
      THFREQ_TAR_PREM,
      THFREQ_MOD_PREM,
      THFREQ_FIN_PREM,
      TH_TAR_PREM,
      TH_MOD_PREM,
      TH_FIN_PREM,
      WEFREQ_TAR_PREM,
      WEFREQ_MOD_PREM,
      WEFREQ_FIN_PREM,
      WE_TAR_PREM,
      WE_MOD_PREM,
      WE_FIN_PREM,
      AC_TAR_PREM,
      AC_MOD_PREM,
      AC_FIN_PREM,
      AC_COST,
      QS_TAR_PREM,
      QS_MOD_PREM,
      QS_FIN_PREM,
      QS_COST,
      AEFREQ_TAR_PREM,
      AEFREQ_MOD_PREM,
      AEFREQ_FIN_PREM,
      AE_TAR_PREM,
      AE_MOD_PREM,
      AE_FIN_PREM,
      COR_TAR_PREM,
      COR_MOD_PREM,
      COR_FIN_PREM,
      WGFREQ_TAR_PREM,
      WGFREQ_MOD_PREM,
      WGFREQ_FIN_PREM,
      WG_TAR_PREM,
      WG_MOD_PREM,
      WG_FIN_PREM,
      GL_TAR_PREM,
      GL_MOD_PREM,
      GL_FIN_PREM,
      GL_PRM,
      HCFREQ_TAR_PREM,
      HCFREQ_MOD_PREM,
      HCFREQ_FIN_PREM,
      HC_TAR_PREM,
      HC_MOD_PREM,
      HC_FIN_PREM,
      PC_HCPRM_TAR_PREM,
      PC_HCPRM_MOD_PREM,
      PC_HCPRM_FIN_PREM,
      HIRE_CAR_PREMIUM2,
      PC_HCPRC_TAR_PREM,
      PC_HCPRC_MOD_PREM,
      PC_HCPRC_FIN_PREM,
      HIRE_CAR_PREMIUM_COMMISSION,
      PC_BRKPRM_TAR_PREM,
      PC_BRKPRM_MOD_PREM,
      PC_BRKPRM_FIN_PREM,
      BREAKDOWN_PREMIUM2,
      PC_BRKPRC_TAR_PREM,
      PC_BRKPRC_MOD_PREM,
      PC_BRKPRC_FIN_PREM,
      BREAKDOWN_PREMIUM_COMMISSION,
      CH_TAR_PREM,
      CH_MOD_PREM,
      CH_FIN_PREM,
      PC_CORVEH_TAR_PREM,
      PC_CORVEH_MOD_PREM,
      VEHICLE_PREMIUM3,
      POLICY_TERM_IN_MONTHS2,
      POLICY_TERM_FACTOR,
      CAPPING_FACTOR,
      KEEP_FACTOR2,
      ADMIN_FEE,
      FINANCE_FEE2,
      CARBON_PREMIUM_GST,
      CARBON_PREMIUM_STD,
      CARBON_PREMIUM_FSL,
      HIRE_CAR_PREMIUM_GST,
      HIRE_CAR_PREMIUM_STD,
      HIRE_CAR_PREMIUM_FSL,
      BREAKDOWN_PREMIUM_GST,
      BREAKDOWN_PREMIUM_STD,
      BREAKDOWN_PREMIUM_FSL,
      ADMIN_FEE_GST,
      VEHICLE_COMMISSION_GST,
      CARBON_PREMIUM_COMMISSION,
      HIRE_CAR_COMMISSION_GST,
      BREAKDOWN_COMMISSION_GST,
      FINANCE_FEE_GST2,
      RD_AT_FAULT_CLAIM_1YR_PREV,
      RD_EXCLUDING_WEATHER_COUNT_1YR_P,
      DIRECT_COST,
      ACTUARIAL_COST2,
      DIRECT_COST2,
      GROSS_MARGIN2)
  FROM (
    SELECT
      * EXCEPT(
        -- useless field that we don't need and high null count.
        -- this is marked as useless drop in the ATT.xlsx.
        -- remove it from AL_ARCHIVE in the future to save space.
        FILE_KEY,
        FILE_NAME,
        RATEBOOK_VERSION,
        DATA_DICTIONARY_VERSION,
        POLICY_OBJECT,
        AFNTY_ENTITY,
        AFNTY_GROUP,
        AMENDMENT_BEGIN_DATE,
        AMENDMENT_END_DATE,
        AMENDMENT_SEQUENCE_NUMBER,
        BD_LICENCE_COUNTRY,
        BREAKDOWN_OPTION,
        CANCELLATION_EFFECTIVE_DATE,
        CANCELLATION_REASON_CODE,
        CANCELLATION_REASON_DESCRIPTION,
        CANCELLATION_REASON_FLAG,
        CANCELLATION_REASON_GROUP,
        CHOICE_OF_REPAIRER,
        CLIENT_NUMBER,
        EARNED_UNIT,
        EARNIX_FACTOR,
        GNAF_PID,
        HIRE_CAR_OPTION,
        LEAD_SOURCE,
        LEAD_STATUS,
        MEDIA_TYPE,
        NCD_CONFIRMED_STATUS,
        NCD_PROTECTION,
        NEXT_POLICY_SEQUENCE_NUMBER,
        NVI_CODE,
        OCCUPATION_STATUS,
        POLICY_HOLDER_TYPE,
        POLICY_SEQUENCE_NUMBER,
        RATE_EFFECTIVE_DATE,
        RATING_PROCESS_MODE,
        RATING_1_FOR_LIFE,
        RD_IRS_CALL_RETURN_STATUS,
        RD_LICENCE_COUNTRY,
        RD_OCCUPATION_STATUS,
        SA1_CODE,
        STAFF_POLICY_FLAG,
        UNDERWRITING_RESULT,
        VARIANT_SUFFIX,
        VEHICLE_INCEPTION_DATE,
        VEHICLE_STATS_DESCRIPTION,
        WINDSCREEN_OPTION,
        PREVIOUS_INSURANCE_1YR,
        INSURANCE_HELD_YRS,
        RISK_ADDRESS,
        CAR_REGISTRATION_NUMBER,
        ENX_EARNIX_INPUT_DATA_MAP,
        RATEBOOK_NAME,
        RATEBOOK_VERSION2,
        RATEBOOK_PROGRAM,
        RATING_TIMESTAMP,
        RATE_EFFECTIVE_DATE2,
        TEST_MODE,
        CALLED_BY_UNDERWRITING,
        TO_LOCK_EARNIX,
        STANDARD_UNDERWRITING_FACTOR,
        RATING_CONTROL_KEY,
        COMMISSION_GROUP_CODE,
        COMMISSION_ENTITY_CODE,
        COMMISSION_BROKER_REFERENCE,
        ADJUSTMENT_FACTOR,
        EARNIX_GROUP,
        EARNIX_CODE,
        RENEWAL_COUNT2,
        KEEP_FACTOR,
        RATING_PROCESS_MODE2,
        RUNTIME_MODE,
        PC_COMBINERATEBOOKS_RUN,
        PC_CORVEH_RUN,
        PC_GROSSUP_RUN,
        OD_RUN,
        ODFREQ_RUN,
        ODSEV_RUN,
        TP_RUN,
        TPFREQ_RUN,
        TPSEV_RUN,
        TH_RUN,
        THFREQ_RUN,
        THSEV_RUN,
        WE_RUN,
        WEFREQ_RUN,
        WESEV_RUN,
        AC_RUN,
        QS_RUN,
        AE_RUN,
        AEFREQ_RUN,
        AESEV_RUN,
        COR_RUN,
        WGFREQ_RUN,
        WG_RUN,
        WGSEV_RUN,
        GL_RUN,
        HC_RUN,
        HCFREQ_RUN,
        HCSEV_RUN,
        PC_HCPRM_RUN,
        PC_HCPRC_RUN,
        PC_BRKPRM_RUN,
        PC_BRKPRC_RUN,
        CH_RUN,
        ORIGINAL_ERF_FOUND,
        FLOAT_ENTERPRISE,
        EARNIX_FACTOR2,
        IS_EARNIX_ALREADY_LOCKED,
        IS_OPTIMISED,
        RATING_TIMESTAMP2,
        RATING_CONTROL_KEY2,
        RATING_LOGGING_KEY2,
        PC_GROSSUP_TAR_PREM,
        PC_GROSSUP_MOD_PREM,
        PC_GROSSUP_FIN_PREM,
        ODSEV_TAR_PREM,
        ODSEV_MOD_PREM,
        ODSEV_FIN_PREM,
        TPSEV_TAR_PREM,
        TPSEV_MOD_PREM,
        TPSEV_FIN_PREM,
        THSEV_TAR_PREM,
        THSEV_MOD_PREM,
        THSEV_FIN_PREM,
        WESEV_TAR_PREM,
        WESEV_MOD_PREM,
        WESEV_FIN_PREM,
        AESEV_TAR_PREM,
        AESEV_MOD_PREM,
        AESEV_FIN_PREM,
        WG_FREQ,
        WGSEV_TAR_PREM,
        WGSEV_MOD_PREM,
        WGSEV_FIN_PREM,
        WG_COST,
        HCSEV_TAR_PREM,
        HCSEV_MOD_PREM,
        HCSEV_FIN_PREM,
        ADJUSTMENT_FACTOR2,
        EARNIX_FACTOR3,
        VEHICLE_PREMIUM_COMMISSION2,
        VEHICLE_PREMIUM_GST,
        VEHICLE_PREMIUM_STD,
        VEHICLE_PREMIUM_FSL,
        TAX_PREMIUM,
        IMPORT_DATETIME,
        HOME_OWNERSHIP2,
        C_PC_CORVEH_RUN,
        C_PC_GROSSUP_RUN,
        C_OD_RUN,
        C_ODFREQ_RUN,
        C_ODSEV_RUN,
        C_TP_RUN,
        C_TPFREQ_RUN,
        C_TPSEV_RUN,
        C_TH_RUN,
        C_THFREQ_RUN,
        C_THSEV_RUN,
        C_WE_RUN,
        C_WEFREQ_RUN,
        C_WESEV_RUN,
        C_AE_RUN,
        C_AEFREQ_RUN,
        C_AESEV_RUN,
        C_WGFREQ_RUN,
        C_WG_RUN,
        C_WGSEV_RUN,
        NC_PC_CORVEH_RUN,
        NC_TP_RUN,
        NC_TPFREQ_RUN,
        NC_TPSEV_RUN,
        NC_TH_RUN,
        NC_THFREQ_RUN,
        NC_THSEV_RUN,
        NC_CH_RUN,
        NC_MARGIN_GROSSUP_RUN,
        NC_PC_GROSSUP_RUN,
        C_CH_RUN,
        C_HC_RUN,
        C_HCFREQ_RUN,
        C_HCSEV_RUN,
        C_PC_GROSSUP_TAR_PREM,
        C_PC_GROSSUP_MOD_PREM,
        C_PC_GROSSUP_FIN_PREM,
        C_ODFREQ_TAR_PREM,
        C_ODFREQ_MOD_PREM,
        C_ODFREQ_FIN_PREM,
        C_ODSEV_TAR_PREM,
        C_ODSEV_MOD_PREM,
        C_ODSEV_FIN_PREM,
        C_OD_TAR_PREM,
        C_OD_MOD_PREM,
        C_OD_FIN_PREM,
        C_TPFREQ_TAR_PREM,
        C_TPFREQ_MOD_PREM,
        C_TPFREQ_FIN_PREM,
        C_TPSEV_TAR_PREM,
        C_TPSEV_MOD_PREM,
        C_TPSEV_FIN_PREM,
        C_TP_TAR_PREM,
        C_TP_MOD_PREM,
        C_TP_FIN_PREM,
        C_THFREQ_TAR_PREM,
        C_THFREQ_MOD_PREM,
        C_THFREQ_FIN_PREM,
        C_THSEV_TAR_PREM,
        C_THSEV_MOD_PREM,
        C_THSEV_FIN_PREM,
        C_TH_V2020_TARIFF_PREMIUM,
        C_TH_MOD_PREM,
        C_TH_FIN_PREM,
        C_WEFREQ_TAR_PREM,
        C_WEFREQ_MOD_PREM,
        C_WEFREQ_FIN_PREM,
        C_WESEV_TAR_PREM,
        C_WESEV_MOD_PREM,
        C_WESEV_FIN_PREM,
        C_WE_TAR_PREM,
        C_WE_MOD_PREM,
        C_WE_FIN_PREM,
        C_AEFREQ_TAR_PREM,
        C_AEFREQ_MOD_PREM,
        C_AEFREQ_FIN_PREM,
        C_AESEV_TAR_PREM,
        C_AESEV_MOD_PREM,
        C_AESEV_FIN_PREM,
        C_AE_TAR_PREM,
        C_AE_MOD_PREM,
        C_AE_FIN_PREM,
        C_PC_CORVEH_TAR_PREM,
        C_PC_CORVEH_MOD_PREM,
        C_PC_CORVEH_FIN_PREM,
        C_WGFREQ_TAR_PREM,
        C_WGFREQ_MOD_PREM,
        C_WGFREQ_FIN_PREM,
        C_WGSEV_TAR_PREM,
        C_WGSEV_MOD_PREM,
        C_WGSEV_FIN_PREM,
        C_WG_TAR_PREM,
        C_WG_MOD_PREM,
        C_WG_FIN_PREM,
        NC_TPFREQ_TAR_PREM,
        NC_TPFREQ_MOD_PREM,
        NC_TPFREQ_FIN_PREM,
        NC_TPSEV_TAR_PREM,
        NC_TPSEV_MOD_PREM,
        NC_TPSEV_FIN_PREM,
        NC_TP_TAR_PREM,
        NC_TP_MOD_PREM,
        NC_TP_FIN_PREM,
        NC_THFREQ_TAR_PREM,
        NC_THFREQ_MOD_PREM,
        NC_THFREQ_FIN_PREM,
        NC_THSEV_TAR_PREM,
        NC_THSEV_MOD_PREM,
        NC_THSEV_FIN_PREM,
        NC_TH_V2020_TARIFF_PREMIUM,
        NC_TH_MOD_PREM,
        NC_TH_FIN_PREM,
        NC_CH_TAR_PREM,
        NC_CH_MOD_PREM,
        NC_CH_FIN_PREM,
        NC_MARGIN_GROSSUP_TAR_PREM,
        NC_MARGIN_GROSSUP_MOD_PREM,
        NC_MARGIN_GROSSUP_FIN_PREM,
        NC_PC_GROSSUP_TAR_PREM,
        NC_PC_GROSSUP_MOD_PREM,
        NC_PC_GROSSUP_FIN_PREM,
        NC_PC_CORVEH_TAR_PREM,
        NC_PC_CORVEH_MOD_PREM,
        NC_PC_CORVEH_FIN_PREM,
        C_CH_TAR_PREM,
        C_CH_MOD_PREM,
        C_CH_FIN_PREM,
        C_HCFREQ_TAR_PREM,
        C_HCFREQ_MOD_PREM,
        C_HCFREQ_FIN_PREM,
        C_HCSEV_TAR_PREM,
        C_HCSEV_MOD_PREM,
        C_HCSEV_FIN_PREM,
        C_HC_V2020_TARIFF_PREMIUM,
        C_HC_MOD_PREM,
        C_HC_FIN_PREM,
        OPTIMISED_PREMIUM,
        EARNIX_DEMAND,
        PREDICTIVE_PRIORITISATION,
        EARNIX_GROUP2,
        EARNIX_CODE2,
        IS_OPTIMISED2,
        OPTIMISED_PREMIUM2,
        EARNIX_DEMAND2,
        PREDICTIVE_PRIORITISATION2,
        FULLTEMPLNAME,
        EPPEPP,
        VEHICLE_COLOUR2 )
    FROM
      `pricing-nonprod-687b.ML.AL_ARCHIVE`
    WHERE
      1=1
      AND AFNTY_BRAND='BUDD' ) )